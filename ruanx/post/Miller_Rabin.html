<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="shortcut icon" href="https://jwjawa.gitee.io/cdn/img/ruanx/favicon.ico">
	<meta charset="UTF-8">
	<meta content="IE=edge" http-equiv="X-UA-Compatible">
	<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no, width=device-width" name="viewport">
	<title>Miller_Rabin判素 - blue's blog</title>
	<!-- css -->
	<link href="/ruanx/css/base.min.css" rel="stylesheet">
	<link href="https://jwjawa.gitee.io/cdn/css/ruanx/project.min.css" rel="stylesheet">
	<link href="https://jwjawa.gitee.io/cdn/css/ruanx/styles.css" rel="stylesheet">


	<script type="text/x-mathjax-config">
  		MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
	</script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

</head>
<body class="page-brand">
	
	<nav class="menu menu-left nav-drawer nav-drawer-md" id="ui_menu">
		<div class="menu-scroll">
			<div class="menu-content">
				<a class="menu-logo" href="/ruanx/index.html">blue的博客</a>
				<ul class="nav">
					<li>
						<a class="collapsed waves-attach waves-effect" data-toggle="collapse" href="#posts">OI笔记</a>	
						<ul class="menu-collapse collapse in" id="posts">
						
							<li>
								<a class="waves-attach" href="/ruanx/post/特征方程.html">特征方程教程</a>
							</li><li>
								<a class="waves-attach" href="/ruanx/post/近似算法.html">近似算法</a>
							</li><li>
								<a class="waves-attach" href="/ruanx/post/SG函数.html">SG函数</a>
							</li><li>
								<a class="waves-attach" href="/ruanx/post/Matrix-Tree.html">Matrix-Tree定理</a>
							</li><li>
								<a class="waves-attach" href="/ruanx/post/polya.html">polya定理</a>
							</li><li>
								<a class="waves-attach" href="/ruanx/post/NOIP2016.html">NOIP2016游记</a>
							</li><li>
								<a class="waves-attach" href="/ruanx/post/有限微积分.html">差分与有限微积分</a>
							</li><li>
								<a class="waves-attach" href="/ruanx/post/概率论.html">概率论</a>
							</li><li>
								<a class="waves-attach" href="/ruanx/post/博弈论.html">博弈论入门</a>
							</li><li>
								<a class="waves-attach" href="/ruanx/post/级数相关.html">级数相关</a>
							</li><li>
								<a class="waves-attach" href="/ruanx/post/母函数.html">浅谈母函数</a>
							</li><li>
								<a class="waves-attach" href="/ruanx/post/FFT.html">FFT入门</a>
							</li><li>
								<a class="waves-attach" href="/ruanx/post/三分查找.html">三分查找</a>
							</li><li class="active">
								<a class="waves-attach" href="/ruanx/post/Miller_Rabin.html">Miller_Rabin判素</a>
							</li><li>
								<a class="waves-attach" href="/ruanx/post/HNSDFZ-Round4酱油记.html">HNSDFZ#4 酱油记</a>
							</li><li>
								<a class="waves-attach" href="/ruanx/post/牛顿迭代.html">牛顿迭代法</a>
							</li><li>
								<a class="waves-attach" href="/ruanx/post/泰勒展开.html">泰勒展开</a>
							</li><li>
								<a class="waves-attach" href="/ruanx/post/狄利克雷卷积.html">狄利克雷卷积</a>
							</li><li>
								<a class="waves-attach" href="/ruanx/post/单调队列.html">单调队列</a>
							</li><li>
								<a class="waves-attach" href="/ruanx/post/数值积分算法.html">数值积分算法</a>
							</li><li>
								<a class="waves-attach" href="/ruanx/post/字符串hash.html">字符串hash</a>
							</li><li>
								<a class="waves-attach" href="/ruanx/post/MEET-IN-THE-MIDDLE.html">Meet in the Middle</a>
							</li><li>
								<a class="waves-attach" href="/ruanx/post/定积分.html">定积分与牛顿-莱布尼兹公式</a>
							</li><li>
								<a class="waves-attach" href="/ruanx/post/HNSDFZ-Round3胡策记.html">HNSDFZ#3 胡策记</a>
							</li><li>
								<a class="waves-attach" href="/ruanx/post/数学归纳法.html">数学归纳法</a>
							</li><li>
								<a class="waves-attach" href="/ruanx/post/导数.html">导数</a>
							</li><li>
								<a class="waves-attach" href="/ruanx/post/普通线段树.html">普通线段树</a>
							</li><li>
								<a class="waves-attach" href="/ruanx/post/矩阵与递推.html">矩阵与递推</a>
							</li>						</ul>

						<a class="collapsed waves-attach waves-effect" data-toggle="collapse" href="#hack">渗透日志</a>	
						<ul class="menu-collapse collapse in" id="hack">
							
							<li>
								<a class="waves-attach" href="/ruanx/hack/XSS.html">初探XSS</a>
							</li>						</ul>

					</li>
					
				</ul>
			</div>
		</div>
	</nav>

	<header class="header header-transparent header-waterfall ui-header">
		<ul class="nav nav-list pull-left hidden-md hidden-lg">
			<li>
				<a data-toggle="menu" href="#ui_menu">
					<span class="icon icon-lg">menu</span>
				</a>
			</li>
		</ul>
		<span class="header-logo header-affix visible-md-block visible-lg-block margin-right-no" data-offset-top="0" data-spy="affix">
			<p class="pagetitle">Miller_Rabin判素</p>
		</span>
		
		<ul class="nav nav-list pull-right">
			<li>
				<a data-toggle="menu" href="/ruanx/index.html">
					<span class="avatar avatar-sm"><img alt="blue" src="https://i.loli.net/2017/10/21/59eb6654682d2.png"></span>
				</a>
			</li>
		</ul>
	</header>
	<main class="content">
		<div class="container">
			<div class="row">
				<div class="col-lg-6 col-lg-offset-3 col-md-10 col-md-offset-1">
					<section class="content-inner margin-top-no">
						<br>
						
<h1>Miller-Rabin判素法</h1>
<h3>身败名裂的阮行止这篇文章出错了。</h3>
<h3>注意下面介绍的算法只是伪素数测试</h3>
<p>给定一个数<mathjax>$n$</mathjax>，判断它是否是<strong>质数</strong>。<mathjax>$n&lt;=2\times 10^9$</mathjax>.</p>
<p>回顾以前判断素数的办法。我们把<mathjax>$n$</mathjax>在<mathjax>$[1,\sqrt{n}]$</mathjax>的范围内试除，看是否有数能整除<mathjax>$n$</mathjax>。算法的时间复杂度是<mathjax>$O(\sqrt{n})$</mathjax>的。这里跑不过。</p>
<h2>费马小定理</h2>
<p><mathjax>$\forall n\in Z_+$</mathjax>、<mathjax>$p$</mathjax>为质数，有<mathjax>$n^{p}\equiv n \pmod p$</mathjax>.<br />
更一般的<strong>欧拉定理</strong>：<mathjax>$\forall \gcd(p,n)=1$</mathjax>，有<mathjax>$n^{\varphi(p)} \equiv 1 \pmod p$</mathjax>.  </p>
<p>考虑费马小定理的<strong>逆命题</strong>。<br />
若<mathjax>$n^{p}\equiv n \pmod p$</mathjax>，则<mathjax>$p$</mathjax>为质数。</p>
<p>这个命题显然是错的，但是它<strong>几乎</strong>成立。因此我们可以用它来判定素数。  </p>
<h2>伪素数判断</h2>
<p>随机选择<mathjax>$x$</mathjax>，如果<mathjax>$x^n \not\equiv x \pmod n$</mathjax>，那么<mathjax>$n$</mathjax>肯定不是质数。</p>
<p>因为有可能出错，所以我们选择<strong>多个底数</strong>来测试。如果所有的测试都认为<mathjax>$n$</mathjax>是质数，那么我们就认为它是质数。</p>
<p>这样写：  </p>
<pre class="codehilite"><code class="language-cpp">bool is_prime(int x)
{
    int i,x;
    for(i=0;i&lt;lambda;i++)
    {
        x=rand()%n+1;
        if((pow(x,n)%n)!=x) return 0;       //发现不符合
    }
    return 1;
}</code></pre>


<p>lambda是测试次数。这个东西设为多少看数据范围。  </p>
<p>最终代码：</p>
<pre class="codehilite"><code class="language-cpp">#define lambda 233

long long pow(long long a,long long b,long long mod)       
{
    long long tmp;
    if(b==0) return 1;
    if(b==1) return a;

    tmp=pow(a,b/2,mod);
    if(b%2==0) return tmp%mod*tmp%mod; //b是偶数
    else return tmp%mod*tmp%mod*a%mod;     //b是奇数
}//快速幂，计算a^b对mod取模的结果

bool is_prime(long long n)
{
    long long i,x;

    for(i=0;i&lt;lambda;i++)
    {
        x=rand()%(n-1)+1;               //随便选个[1,n-1]的数
        if(pow(x,n,n)!=x) return 0;     //如果x^n模n的结果不是n,则n必不是质数
    }

    return 1;
}//质数返回1,合数返回0</code></pre>


<h2>复杂度讨论</h2>
<p>这东西的复杂度是多少呢？</p>
<p>对于每一次测试<mathjax>$x$</mathjax>，快速幂计算<mathjax>$x^n$</mathjax>将会耗费<mathjax>$log_n$</mathjax>的时间。<br />
那么总的时间复杂度就是<mathjax>$\lambda * log_n$</mathjax>。</p>
<h2>tyvj P4192 素数测试</h2>
<p>给定一个<mathjax>$n$</mathjax>，判断<mathjax>$n$</mathjax>是否为质数。  </p>
<p>Code  </p>
<pre class="codehilite"><code class="language-cpp">#include &lt;cstdio&gt;
#include &lt;cstdlib&gt;

#define lambda 10

long long pow(long long a,long long b,long long mod)       //快速幂，计算a^b对mod取模的结果
{
    long long tmp;
    if(b==0) return 1;
    if(b==1) return a;

    tmp=pow(a,b/2,mod);
    if(b%2==0) return tmp%mod*tmp%mod; //b是偶数
    else return tmp%mod*tmp%mod*a%mod;     //b是奇数
}

bool is_prime(long long n)
{
    long long i,x;

    for(i=0;i&lt;lambda;i++)
    {
        x=rand()%(n-1)+1;               //随便选个[1,n-1]的数
        if(pow(x,n,n)!=x) return 0;     //如果x^n模n的结果不是n,则n必不是质数
    }

    return 1;
}

int main()
{
    long long x;
    scanf(&quot;%lld&quot;,&amp;x);
    printf(&quot;%s\n&quot;,Miller_Rabin(x)==0?&quot;No&quot;:&quot;Yes&quot;);
}</code></pre>


<p>由于tyvj数据很水，lambda取1(只测试一次)都能过……</p>
<hr />
<p>update on 2016.8.31</p>
<p><strong>关于出错</strong>  </p>
<p>经过证明，如果是真的<code>Miller-Rabin</code>算法，取<strong>前二十个质数</strong>为底数来测验，可以保证在<code>int</code>范围内不出错。  </p>
						
					</section>
				</div>
			</div>

			<div class="row">
				<div class="col-lg-6 col-lg-offset-3 col-md-10 col-md-offset-1">
					<section class="content-inner margin-top-no">
						<hr>
						
							CC0协议 @ ruanxingzhi 2017.
						<a style="float:right" href="/ruanx/CC0.html">CC0是啥玩意?</a>
					</section>
				</div>
			</div>


		</div>


	</main>
	
	<div class="fbtn-container">
		<div class="fbtn-inner">
			<a class="fbtn fbtn-lg fbtn-brand-accent waves-attach waves-circle waves-light" data-toggle="dropdown">
				<span class="fbtn-text fbtn-text-left">Home</span>
				<span class="fbtn-ori icon">apps</span>
				<span class="fbtn-sub icon">close</span>
			</a>
			<div class="fbtn-dropup">
				<a class="fbtn waves-attach waves-circle" href="/ruanx/about.html" target="_blank">
					<span class="fbtn-text fbtn-text-left">关于作者</span><span class="icon">perm_identity</span>
				</a>
				<a class="fbtn waves-attach waves-circle" href="https://coding.net/u/ruanxingzhi/p/blog/topic" target="_blank">
					<span class="fbtn-text fbtn-text-left">反馈</span><span class="icon">feedback</span>
				</a>
				<a class="fbtn fbtn-green waves-attach waves-circle" href="/ruanx/index.html" target="_self">
					<span class="fbtn-text fbtn-text-left">返回主页</span><span class="icon">home</span>
				</a>
			</div>
		</div>
	</div>

	

	<!-- js -->
	<script src="https://jwjawa.gitee.io/cdn/js/ruanx/jquery.min.js"></script>
	<script src="https://jwjawa.gitee.io/cdn/js/ruanx/base.min.js"></script>
</body>
</html>
